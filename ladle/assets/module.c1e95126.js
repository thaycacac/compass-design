import{r as n,R}from"./index.cebab68f.js";import{c as C,d as N,e as x,f as y,g as S,b as $,h as M,i as P,j as p,k as g}from"./module.e467d91e.js";function V(t){if(M()==="virtual"){let e=document.activeElement;P(()=>{document.activeElement===e&&document.contains(t)&&p(t)})}else p(t)}function L(t){if(!(t instanceof HTMLElement)&&!(t instanceof SVGElement))return!1;let{display:e,visibility:s}=t.style,r=e!=="none"&&s!=="hidden"&&s!=="collapse";if(r){const{getComputedStyle:i}=t.ownerDocument.defaultView;let{display:o,visibility:a}=i(t);r=o!=="none"&&a!=="hidden"&&a!=="collapse"}return r}function w(t,e){return!t.hasAttribute("hidden")&&(t.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?t.hasAttribute("open"):!0)}function v(t,e){return t.nodeName!=="#comment"&&L(t)&&w(t,e)&&(!t.parentElement||v(t.parentElement,t))}const f=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],I=f.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";f.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const A=f.join(':not([hidden]):not([tabindex="-1"]),');function F(t,e){return e.some(s=>s.contains(t))}function W(t,e,s){let r=e!=null&&e.tabbable?A:I,i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode(o){var a;return!(e==null||(a=e.from)===null||a===void 0)&&a.contains(o)?NodeFilter.FILTER_REJECT:o.matches(r)&&v(o)&&(!s||F(o,s))&&(!(e!=null&&e.accept)||e.accept(o))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(i.currentNode=e.from),i}class u{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,s,r){let i=this.fastMap.get(s!=null?s:null),o=new h({scopeRef:e});i.addChild(o),o.parent=i,this.fastMap.set(e,o),r&&(o.nodeToRestore=r)}removeTreeNode(e){if(e===null)return;let s=this.fastMap.get(e),r=s.parent;for(let o of this.traverse())o!==s&&s.nodeToRestore&&o.nodeToRestore&&s.scopeRef.current&&F(o.nodeToRestore,s.scopeRef.current)&&(o.nodeToRestore=s.nodeToRestore);let i=s.children;r.removeChild(s),i.length>0&&i.forEach(o=>r.addChild(o)),this.fastMap.delete(s.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.length>0)for(let s of e.children)yield*this.traverse(s)}clone(){let e=new u;for(let s of this.traverse())e.addTreeNode(s.scopeRef,s.parent.scopeRef,s.nodeToRestore);return e}constructor(){this.fastMap=new Map,this.root=new h({scopeRef:null}),this.fastMap.set(null,this.root)}}class h{addChild(e){this.children.push(e),e.parent=this}removeChild(e){this.children.splice(this.children.indexOf(e),1),e.parent=void 0}constructor(e){this.children=[],this.contain=!1,this.scopeRef=e.scopeRef}}new u;function j(t={}){let{autoFocus:e=!1,isTextInput:s,within:r}=t,i=n.exports.useRef({isFocused:!1,isFocusVisible:e||C()}),[o,a]=n.exports.useState(!1),[c,E]=n.exports.useState(()=>i.current.isFocused&&i.current.isFocusVisible),l=n.exports.useCallback(()=>E(i.current.isFocused&&i.current.isFocusVisible),[]),b=n.exports.useCallback(d=>{i.current.isFocused=d,a(d),l()},[l]);N(d=>{i.current.isFocusVisible=d,l()},[],{isTextInput:s});let{focusProps:T}=x({isDisabled:r,onFocusChange:b}),{focusWithinProps:m}=y({isDisabled:!r,onFocusWithinChange:b});return{isFocused:o,isFocusVisible:i.current.isFocused&&c,focusProps:r?m:T}}let _=R.createContext(null);function k(t){let e=n.exports.useContext(_)||{};g(e,t);let{ref:s,...r}=e;return r}function B(t,e){let{focusProps:s}=x(t),{keyboardProps:r}=S(t),i=$(s,r),o=k(e),a=t.isDisabled?{}:o,c=n.exports.useRef(t.autoFocus);return n.exports.useEffect(()=>{c.current&&e.current&&V(e.current),c.current=!1},[e]),{focusableProps:$({...i,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},a)}}export{B as $,V as a,W as b,j as c};
